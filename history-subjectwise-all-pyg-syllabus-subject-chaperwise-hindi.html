<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>STISkilli ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ ‚Äì ‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§®, ‡§Æ‡§ß‡•ç‡§Ø‡§ï‡§æ‡§≤‡•Ä‡§®, ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï, ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§î‡§∞ ‡§ï‡§≤‡§æ ‡§ï‡•á ‡§™‡§ø‡§õ‡§≤‡•á ‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§ï‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§®</title>
<script src="/app-redirect.js"></script>
<meta name="description" content="STISkilli ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç ‚Äì ‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§®, ‡§Æ‡§ß‡•ç‡§Ø‡§ï‡§æ‡§≤‡•Ä‡§®, ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï, ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§î‡§∞ ‡§ï‡§≤‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø ‡§ï‡•á ‡§™‡§ø‡§õ‡§≤‡•á ‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§ï‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•§ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ AI-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä, ‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ‡§ì‡§Ç, ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§î‡§∞ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è‡•§">
<meta name="keywords" content="‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ, ‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ, ‡§Æ‡§ß‡•ç‡§Ø‡§ï‡§æ‡§≤‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ, ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ, ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ, ‡§ï‡§≤‡§æ ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø PYQ, ‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏, STISkilli">
<meta name="author" content="StiSkilli">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="googlebot" content="index, follow">
<!-- VIEWPORT -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<!-- CANONICAL (APP LINK USED) -->
<link rel="canonical" href="https://play.google.com/store/apps/details?id=com.ai.skillaura">
<!-- =========================
     OPEN GRAPH (SOCIAL SEO)
========================== -->
<meta property="og:type" content="website">
<meta property="og:title" content="StiSkilli ‚Äì ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§î‡§∞ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ó‡§æ‡§á‡§° 2026">
<meta property="og:description" content="‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ‡§ì‡§Ç, AI ‡§ü‡•Ç‡§≤‡•ç‡§∏, ‡§®‡•å‡§ï‡§∞‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç, ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§î‡§∞ ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è SkillAura AI ‡§ê‡§™ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§è‡§ï ‡§ê‡§™ ‚Äì ‡§∏‡§≠‡•Ä ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®‡•§">
<meta property="og:url" content="https://play.google.com/store/apps/details?id=com.ai.skillaura&pcampaignid=web_share">
<meta property="og:image" content="https://play-lh.googleusercontent.com/your-app-icon.png">
<meta property="og:site_name" content="StiSkilli">
<!-- =========================
     TWITTER / X SEO
========================== -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="StiSkilli ‚Äì ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§ï‡§æ ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§î‡§∞ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ó‡§æ‡§á‡§°">
<meta name="twitter:description" content="AI ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ, ‡§®‡•å‡§ï‡§∞‡•Ä ‡§î‡§∞ ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§ó‡§æ‡§á‡§° ‡§ê‡§™‡•§ Google Play Store ‡§∏‡•á SkillAura AI ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§">
<meta name="twitter:image" content="https://play-lh.googleusercontent.com/your-app-icon.png">
<!-- =========================
     APP DEEP LINK SEO
========================== -->
<meta name="application-name" content="StiSkilli">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#F4C430">
<!-- ANDROID APP INDEXING -->
<link rel="alternate" href="android-app://com.ai.skillaura/https/play.google.com/store/apps/details?id=com.ai.skillaura">
<!-- =========================
     STRUCTURED DATA (JSON-LD)
========================== -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "MobileApplication",
  "name": "StiSkilli",
  "operatingSystem": "Android",
  "applicationCategory": "EducationApplication",
  "description": "STISkilli ‡§è‡§ï ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ü‡•á‡§ï-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§î‡§∞ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§ê‡§™ ‡§π‡•à ‡§ú‡•ã ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡•ã‡§Ç, AI ‡§ü‡•Ç‡§≤‡•ç‡§∏, ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ, ‡§™‡•ç‡§∞‡§æ‡§á‡§µ‡•á‡§ü ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§î‡§∞ ‡§≠‡§æ‡§∞‡§§ ‡§Æ‡•á‡§Ç ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§≠‡§∞‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "INR"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "ratingCount": "100000"
  },
  "url": "https://play.google.com/store/apps/details?id=com.ai.skillaura"
}
</script>

<!-- =========================
     PERFORMANCE & AI SEARCH
========================== -->
<meta name="referrer" content="strict-origin-when-cross-origin">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="format-detection" content="telephone=no">

<!-- =========================
     FAVICON
========================== -->
<link rel="icon" href="https://play-lh.googleusercontent.com/your-app-icon.png" type="image/png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700;800;900&family=Plus+Jakarta+Sans:wght@500;600;700;800&display=swap" rel="stylesheet">
     <!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>STISkilli ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ ‚Äì ‡§™‡•ç‡§∞‡•ã ‡§Ö‡§®‡•Å‡§ï‡•ç‡§∞‡§Æ‡§ø‡§ï ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£</title>
<script src="/app-redirect.js"></script>
<meta name="description" content="STISkilli ‡§á‡§§‡§ø‡§π‡§æ‡§∏ PYQ ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ AI-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä‡•§">
<meta name="robots" content="index, follow">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700;800;900&family=Plus+Jakarta+Sans:wght@500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --primary: #F4C430;       
            --primary-glow: #FFD700; 
            --dark-glass: rgba(10, 10, 10, 0.85);
            --header-height: 70px; 
            --footer-height: 75px; 
            --correct: #00e676;
            --wrong: #ff1744;
            --locked-color: #555;
        }

        /* --- GLOBAL RESET --- */
        html, body {
            margin: 0; padding: 0;
            width: 100%; height: 100dvh;
            overflow: hidden; 
            position: fixed; 
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #000;
            color: #fff;
            overscroll-behavior: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- UNIVERSE BACKGROUND --- */
        #universe-bg {
            position: fixed; top: -10%; left: -10%; width: 120%; height: 120%;
            z-index: -10;
            background: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=2072&auto=format&fit=crop');
            background-size: cover;
            filter: contrast(120%) brightness(40%);
            animation: galaxyMove 60s linear infinite alternate;
        }
        @keyframes galaxyMove { from { transform: scale(1); } to { transform: scale(1.1); } }

        /* --- GOLDEN BORDER ANIMATION --- */
        .golden-border-anim {
            border: 2px solid var(--primary);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            animation: borderPulse 3s infinite alternate;
        }
        @keyframes borderPulse {
            0% { box-shadow: 0 0 10px rgba(244, 196, 48, 0.2); border-color: #bfa128; }
            100% { box-shadow: 0 0 20px rgba(244, 196, 48, 0.6), inset 0 0 10px rgba(244, 196, 48, 0.2); border-color: #ffd700; }
        }

        /* --- HEADER --- */
        .glass-header {
            position: fixed; top: calc(15px + env(safe-area-inset-top)); left: 50%; transform: translateX(-50%);
            width: 94%; max-width: 800px; height: var(--header-height);
            background: rgba(5, 5, 5, 0.85); backdrop-filter: blur(25px);
            border-radius: 24px;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; z-index: 3000;
        }
        .header-logo { width: 44px; height: 44px; border-radius: 12px; border: 1px solid var(--primary); object-fit: cover; box-shadow: 0 0 10px var(--primary-glow); }
        
        .header-title-text {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(to bottom, #FFD700, #B8860B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
            filter: drop-shadow(0 0 5px rgba(244, 196, 48, 0.5));
            text-align: center;
        }

        /* --- DOCK (Footer) --- */
        .dock-wrapper { position: fixed; bottom: calc(20px + env(safe-area-inset-bottom)); left: 0; width: 100%; display: flex; justify-content: center; z-index: 3000; padding: 0 5px; }
        .glass-dock { 
            width: 100%; max-width: 700px; 
            height: var(--footer-height); 
            background: rgba(5, 5, 5, 0.9); backdrop-filter: blur(30px);
            border-radius: 24px; 
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 10px;
        }
        .dock-item { 
            width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; 
            color: rgba(255, 255, 255, 0.3); cursor: pointer; position: relative;
            transition: all 0.3s ease; border-radius: 16px; flex: 1;
        }
        .dock-item i { font-size: 1.4rem; transition: 0.3s; }
        
        .dock-item.active { 
            color: var(--primary-glow); 
            background: radial-gradient(circle, rgba(244, 196, 48, 0.2) 0%, transparent 70%);
            text-shadow: 0 0 20px var(--primary);
        }
        .dock-item.active i { transform: scale(1.1); filter: drop-shadow(0 0 5px var(--primary)); }

        /* LOCKED CATEGORY STYLE */
        .dock-item.cat-locked {
            color: #333 !important;
            cursor: not-allowed;
            pointer-events: auto; /* Allow click to show popup */
        }
        .dock-item.cat-locked i {
            filter: grayscale(100%);
        }
        .lock-badge {
            position: absolute; top: 15px; right: 10px;
            font-size: 0.7rem; color: #fff; background: #000;
            border-radius: 50%; padding: 2px; border: 1px solid #333;
        }

        /* --- MAIN MODAL --- */
        .modal-overlay { 
            position: fixed; 
            top: calc(var(--header-height) + 30px + env(safe-area-inset-top)); 
            bottom: calc(var(--footer-height) + 35px + env(safe-area-inset-bottom)); 
            left: 0; right: 0; 
            z-index: 2500; 
            display: flex; justify-content: center; align-items: center;
            padding: 0 10px; pointer-events: none; 
        }

        .modal-box { 
            pointer-events: auto; 
            background-color: #111; 
            background-size: cover; background-position: center; background-repeat: no-repeat;
            border-radius: 30px; 
            width: 100%; max-width: 1400px; height: 100%; padding: 15px; 
            display: flex; flex-direction: column; overflow: hidden;
            text-shadow: 0 2px 5px rgba(0,0,0,0.9);
            position: relative; 
        }

        /* HEADER INSIDE MODAL */
        .modal-header-container { display: flex; flex-direction: column; align-items: center; margin-bottom: 15px; flex-shrink: 0; }
        .modal-header { text-align: center; background: rgba(0,0,0,0.6); padding: 8px 25px; border-radius: 50px; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.1); margin-bottom: 10px; width: fit-content; min-width: 180px; }
        .modal-header h2 { font-family: 'Rajdhani'; font-weight: 900; font-size: 1.5rem; color: #fff; text-shadow: 0 0 15px rgba(255, 215, 0, 0.8); margin: 0; letter-spacing: 1px; text-transform: uppercase; }
        
        .sub-nav { background: rgba(0,0,0,0.7); border-radius: 20px; padding: 8px; display: flex; gap: 8px; overflow-x: auto; scrollbar-width: none; white-space: nowrap; width: 100%; }
        .sub-item { padding: 8px 20px; border-radius: 12px; font-size: 0.8rem; font-family: 'Rajdhani'; font-weight: 700; color: #ccc; border: 1px solid transparent; transition: 0.3s; cursor: pointer; text-transform: uppercase; display: flex; align-items: center; gap: 5px; }
        .sub-item.active { background: var(--primary); color: #000; border-color: var(--primary-glow); box-shadow: 0 0 20px rgba(244, 196, 48, 0.4); font-weight: 800; }
        .sub-item.locked { opacity: 0.5; cursor: not-allowed; background: #222; border: 1px solid #444; }

        /* --- QUIZ INTERFACE & MODIFIED STATS BAR --- */
        #quiz-interface { flex-grow: 1; display: none; flex-direction: column; overflow-y: auto; padding-bottom: 20px; }
        
        /* UPDATED: Solid Background & Border */
        .quiz-stats-bar {
            display: flex; justify-content: space-between; align-items: center;
            background: #1a1a1a; /* Solid Dark Grey */
            border-radius: 12px;
            padding: 10px 15px; margin-bottom: 15px; 
            border: 2px solid var(--primary); /* Gold Border */
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        /* UPDATED: Custom Editable Header Style */
        .static-header-text {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 900;
            font-size: 1.2rem;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-item { font-family: 'Rajdhani'; font-weight: 700; font-size: 0.9rem; color: #ddd; }

        .question-box {
            background: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
            border-radius: 16px; padding: 20px; margin-bottom: 15px;
            border-left: 3px solid var(--primary);
        }
        .q-text { font-size: 1.1rem; line-height: 1.4; font-weight: 600; color: #fff; }

        .options-list { display: flex; flex-direction: column; gap: 10px; }
        .option-btn {
            background: rgba(30, 30, 30, 0.9); border: 1px solid #444;
            padding: 14px 18px; border-radius: 12px; color: #eee;
            font-weight: 500; cursor: pointer; transition: 0.2s;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 0.95rem;
        }
        .option-btn:active { transform: scale(0.98); }
        .option-btn.correct { background: rgba(0, 230, 118, 0.15); border-color: var(--correct); color: var(--correct); }
        .option-btn.wrong { background: rgba(255, 23, 68, 0.15); border-color: var(--wrong); color: var(--wrong); }

        /* --- EXPLANATION POPUP STYLES (UPDATED WITH SCROLL) --- */
        #explanation-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.85); z-index: 100;
            display: none;
            justify-content: center; align-items: center;
            padding: 20px;
            backdrop-filter: blur(8px);
        }
        
        .expl-box {
            background: rgba(20, 20, 20, 0.98); /* Less transparent for readability */
            border: 2px solid var(--primary);
            border-radius: 24px; padding: 25px;
            width: 100%; max-width: 500px;
            display: flex; flex-direction: column; align-items: center; text-align: center;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            animation: popUpAnim 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            max-height: 80vh; /* Prevent overflowing screen */
        }

        @keyframes popUpAnim { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .expl-box::before {
            content: ''; position: absolute; top: -50px; left: -50px; width: 100px; height: 100px;
            background: var(--primary); filter: blur(60px); opacity: 0.2; pointer-events: none;
        }

        .expl-icon { font-size: 3rem; margin-bottom: 10px; flex-shrink: 0; }
        .expl-title { font-family: 'Rajdhani'; font-weight: 900; font-size: 1.8rem; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; flex-shrink: 0; }
        
        /* UPDATED: SCROLLABLE TEXT AREA */
        .expl-text { 
            color: #ccc; font-size: 1rem; line-height: 1.6; margin-bottom: 25px; 
            font-family: 'Plus Jakarta Sans'; background: rgba(255,255,255,0.05); 
            padding: 15px; border-radius: 12px; width: 100%; 
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 300px; /* Fixed height window */
            overflow-y: auto; /* Vertical Scroll Enabled */
            text-align: left;
        }

        /* Custom Scrollbar for Explanation */
        .expl-text::-webkit-scrollbar { width: 6px; }
        .expl-text::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); border-radius: 4px; }
        .expl-text::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 4px; }

        /* --- OTHER POPUPS --- */
        .overlay-popup {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(5, 5, 5, 0.98); z-index: 50;
            display: none; 
            flex-direction: column; align-items: center; justify-content: center;
            border-radius: 30px; text-align: center;
            padding: 20px;
        }
        .res-emoji { font-size: 4rem; margin-bottom: 15px; }
        .res-title { font-family: 'Rajdhani'; font-size: 2.2rem; font-weight: 900; color: #fff; margin-bottom: 15px; line-height: 1.1; }
        .res-btn { padding: 14px 35px; font-family: 'Rajdhani'; font-weight: 800; font-size: 1.1rem; border-radius: 50px; border: none; cursor: pointer; background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary-glow); margin-top: 10px; transition: 0.3s; width: 100%; max-width: 200px; }
        .res-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 25px var(--primary); }

        .welcome-text { color: #ccc; margin-bottom: 20px; font-size: 1rem; max-width: 80%; line-height: 1.5; }
        .user-highlight { color: var(--primary); font-weight: 800; font-size: 1.2rem; }

        /* --- PRO PROFILE STYLES --- */
        #profile-section { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; overflow-y: auto; padding: 10px 5px; }
        .glass-panel {
            background: rgba(20, 20, 20, 0.7); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 24px; padding: 30px 25px;
            width: 100%; max-width: 500px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; align-items: center;
        }
        .gold-input-group { width: 100%; margin-bottom: 20px; text-align: left; }
        .gold-label { font-size: 0.8rem; color: var(--primary); font-weight: 700; margin-left: 10px; margin-bottom: 5px; display: block; letter-spacing: 1px; }
        .gold-input {
            width: 100%; background: rgba(0,0,0,0.4); border: 1px solid rgba(255, 215, 0, 0.2);
            padding: 15px; border-radius: 12px; color: #fff; font-size: 1rem; transition: 0.3s; outline: none;
        }
        .gold-input:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(244, 196, 48, 0.2); background: rgba(0,0,0,0.6); }
        .btn-pro {
            width: 100%; background: linear-gradient(135deg, #FFD700 0%, #B8860B 100%);
            color: #000; font-family: 'Rajdhani'; font-weight: 800; font-size: 1.2rem;
            padding: 16px; border-radius: 16px; border: none; cursor: pointer; position: relative; overflow: hidden;
            box-shadow: 0 5px 20px rgba(244, 196, 48, 0.3); transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-pro:active { transform: scale(0.98); }
        .plans-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; margin-bottom: 20px; }
        .plan-card-pro {
            background: rgba(30, 30, 30, 0.6); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px; padding: 15px; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .plan-card-pro:hover { background: rgba(40,40,40,0.8); }
        .plan-card-pro.selected { background: rgba(244, 196, 48, 0.15); border: 2px solid var(--primary); box-shadow: 0 0 20px rgba(244, 196, 48, 0.15); }
        .pc-dur { font-size: 0.9rem; color: #ccc; font-weight: 600; }
        .pc-price { font-size: 1.4rem; color: var(--primary); font-family: 'Rajdhani'; font-weight: 800; margin: 5px 0; }
        .pc-check { position: absolute; top: 5px; right: 5px; color: var(--primary); opacity: 0; transition: 0.2s; }
        .plan-card-pro.selected .pc-check { opacity: 1; }

        /* Dashboard */
        .dashboard-container { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 20px; }
        .membership-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #000 100%); border: 1px solid #333;
            border-radius: 24px; padding: 25px; position: relative; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6); display: flex; flex-direction: column; justify-content: space-between;
            min-height: 200px;
        }
        .mc-header { display: flex; justify-content: space-between; align-items: flex-start; z-index: 2; }
        .mc-chip { width: 45px; height: 30px; background: linear-gradient(45deg, #FFD700, #FDB931); border-radius: 6px; position: relative; overflow: hidden; box-shadow: inset 0 0 5px rgba(0,0,0,0.3); }
        .mc-chip::after { content: ''; position: absolute; top:0; left:50%; width:1px; height:100%; background:rgba(0,0,0,0.2); }
        .mc-plan-badge { background: rgba(244, 196, 48, 0.2); border: 1px solid var(--primary); color: var(--primary); padding: 5px 12px; border-radius: 50px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        .mc-user { z-index: 2; margin-top: auto; }
        .mc-name { font-family: 'Rajdhani'; font-size: 1.8rem; font-weight: 800; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.5); letter-spacing: 1px; }
        .mc-email { color: #888; font-size: 0.9rem; margin-top: -2px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-box { background: rgba(30, 30, 30, 0.9); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 18px; padding: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .sb-icon { font-size: 1.2rem; color: #ccc; margin-bottom: 5px; } 
        .sb-val { font-family: 'Rajdhani'; font-size: 1.5rem; font-weight: 800; color: #fff; }
        .sb-label { font-size: 0.7rem; color: #ddd; text-transform: uppercase; font-weight: 700; letter-spacing: 1px; }
        .pro-progress-header { font-family: 'Rajdhani'; font-size: 1.3rem; color: #fff; font-weight: 800; margin-top: 10px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .pp-item { background: linear-gradient(90deg, rgba(20,20,20,0.9) 0%, rgba(30,30,30,0.9) 100%); border-left: 4px solid var(--primary); border-radius: 8px; padding: 15px; margin-bottom: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .pp-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .pp-title { font-size: 0.9rem; font-weight: 700; color: #ddd; }
        .pp-score { background: rgba(244, 196, 48, 0.2); color: var(--primary); padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: 800; font-family: 'Rajdhani'; }
        .pp-bar-bg { width: 100%; height: 6px; background: #111; border-radius: 10px; overflow: hidden; position: relative; }
        .pp-bar-fill { height: 100%; background: linear-gradient(90deg, #F4C430, #FFD700); border-radius: 10px; box-shadow: 0 0 10px var(--primary); transition: width 1s ease; }
        .pp-meta { display: flex; justify-content: flex-end; gap: 15px; font-size: 0.75rem; color: #666; margin-top: 8px; }

        /* --- NEWS/DISCOVERY --- */
        #news-section { width: 100%; height: 100%; display: none; flex-direction: column; overflow-y: auto; padding-bottom: 20px; }
        .news-container { display: flex; flex-direction: column; gap: 15px; padding: 0 5px; }
        .news-card { background: rgba(15, 15, 15, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 16px; overflow: hidden; display: flex; flex-direction: column; transition: transform 0.2s, box-shadow 0.3s; }
        .news-card:active { transform: scale(0.98); }
        .news-img { width: 100%; height: 140px; object-fit: cover; border-bottom: 1px solid #333; }
        .news-body { padding: 15px; }
        .news-tag { font-size: 0.7rem; color: #000; background: var(--primary); padding: 2px 8px; border-radius: 4px; font-weight: 800; display: inline-block; margin-bottom: 8px; font-family: 'Rajdhani'; }
        .news-title { font-size: 1.1rem; font-weight: 700; color: #fff; margin-bottom: 6px; line-height: 1.3; font-family: 'Plus Jakarta Sans'; }
        .news-desc { font-size: 0.85rem; color: #aaa; margin-bottom: 12px; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .news-btn { background: transparent; border: 1px solid var(--primary); color: var(--primary); padding: 8px 15px; border-radius: 8px; font-size: 0.8rem; font-weight: 700; width: 100%; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 5px; transition: 0.3s; }

    </style>
</head>
<body>

    <div id="universe-bg"></div>

    <header class="glass-header golden-border-anim">
        <img class="header-logo" src="sti.png" alt="‡§≤‡•ã‡§ó‡•ã" onerror="this.style.display='none'">
        <div id="app-main-title" class="header-title-text">STISkilli</div>
        <img class="header-logo" src="ytglogo.png" alt="‡§≤‡•ã‡§ó‡•ã" onerror="this.style.display='none'">
    </header>

    <div class="dock-wrapper">
        <nav class="glass-dock golden-border-anim">
            <div id="nav-profile" class="dock-item" onclick="openCategory('profile', this)"><i class="fas fa-user-circle"></i></div>
            
            <div id="nav-ancient" class="dock-item" onclick="openCategory('ancient', this)"><i class="fas fa-gopuram"></i></div>
            <div id="nav-medieval" class="dock-item" onclick="openCategory('medieval', this)"><i class="fas fa-monument"></i></div>
            <div id="nav-modern" class="dock-item" onclick="openCategory('modern', this)"><i class="fas fa-flag"></i></div>
            <div id="nav-world" class="dock-item" onclick="openCategory('world', this)"><i class="fas fa-globe"></i></div>
            <div id="nav-art" class="dock-item" onclick="openCategory('art', this)"><i class="fas fa-palette"></i></div>
            
            <div id="nav-news" class="dock-item" onclick="openCategory('news', this)"><i class="fas fa-newspaper"></i></div>
        </nav>
    </div>

    <div id="main-modal" class="modal-overlay flex-modal">
        <div class="modal-box golden-border-anim" id="dynamic-modal-box">
            
            <div class="modal-header-container" id="common-header">
                <div class="modal-header">
                    <h2 id="cat-title">‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤</h2>
                </div>
                <div class="sub-nav golden-border-anim" id="sub-nav-container"></div>
            </div>

            <div id="news-section">
                <div class="news-container" id="news-feed"></div>
            </div>

            <div id="quiz-interface" style="display: none;">
                <div class="quiz-stats-bar">
                    <div class="stat-item"><span id="static-header-text" class="static-header-text">MCQ</span></div>
                    
                    <div class="stat-item" style="color:#ff1744; font-weight:800;"><i class="fas fa-clock"></i> <span id="q-timer">30</span>‡§∏‡•á</div>
                    <div class="stat-item">‡§™‡•ç‡§∞: <span id="q-num-display" style="color:#fff;">1/25</span></div>
                </div>
                <div class="question-box">
                    <div id="q-text" class="q-text">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                </div>
                <div id="options-list" class="options-list"></div>
            </div>

            <div id="explanation-overlay">
                <div class="expl-box" id="expl-box">
                    <div id="expl-icon" class="expl-icon"></div>
                    <div id="expl-title" class="expl-title">‡§∏‡§π‡•Ä!</div>
                    <div id="expl-text" class="expl-text">
                        ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü‡•Ä‡§ï‡§∞‡§£ ‡§Ø‡§π‡§æ‡§Ç ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à...
                    </div>
                    <button class="res-btn" onclick="closeExplanationAndNext()">‡§Ö‡§ó‡§≤‡§æ <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <div id="result-overlay" class="overlay-popup">
                <div id="res-emoji" class="res-emoji">üéâ</div>
                <div id="res-title" class="res-title">‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§™‡§æ‡§∏!</div>
                <div style="font-size:1.8rem; color:var(--primary); margin-bottom:10px; font-weight:900; font-family:'Rajdhani'; text-shadow:0 0 10px rgba(244,196,48,0.5);">
                    ‡§Ö‡§Ç‡§ï: <span id="final-score">0</span>
                </div>
                <div style="color:#aaa; font-size:1rem;">‡§∏‡§π‡•Ä: <span id="correct-count">0</span> / 25</div>
                <div style="font-size: 0.8rem; color: #ff1744; margin-top: 10px; display:none;" id="fail-msg">‡§™‡•ç‡§∞‡§∂‡•ç‡§® 1 ‡§∏‡•á ‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§™‡•Å‡§®‡§É ‡§Ü‡§∞‡§Ç‡§≠ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à</div>
                <button id="res-btn" class="res-btn" onclick="handleResultAction()">‡§Ö‡§ó‡§≤‡•Ä ‡§Ø‡•Ç‡§®‡§ø‡§ü</button>
            </div>
            
            <div id="category-unlock-popup" class="overlay-popup">
                <div class="res-emoji">üîì</div>
                <div class="res-title" style="color:var(--primary);">‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ú‡•Ä‡§§ ‡§≤‡•Ä ‡§ó‡§à!</div>
                <div class="welcome-text">
                    ‡§Ö‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø! ‡§Ü‡§™‡§®‡•á <span id="completed-cat-name" class="user-highlight">‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏</span> ‡§Æ‡•á‡§Ç ‡§Æ‡§π‡§æ‡§∞‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞ ‡§≤‡•Ä ‡§π‡•à‡•§ <br><br>
                    <span id="unlocked-cat-name" style="color:#00e676; font-weight:bold;">‡§Æ‡§ß‡•ç‡§Ø‡§ï‡§æ‡§≤‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏</span> ‡§Ö‡§¨ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§π‡•à!
                </div>
                <button class="res-btn" onclick="closeCategoryUnlock()">‡§Ö‡§ó‡§≤‡•á ‡§Ø‡•Å‡§ó ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç</button>
            </div>

            <div id="welcome-popup" class="overlay-popup">
                <div class="res-emoji">üëë</div>
                <div class="res-title" style="color:var(--primary);">‡§ï‡•ç‡§≤‡§¨ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!</div>
                <div class="welcome-text">
                    ‡§®‡§Æ‡§∏‡•ç‡§§‡•á <span id="wel-user" class="user-highlight">‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ</span>, <br>
                    ‡§Ö‡§¨ ‡§Ü‡§™ <span style="color:var(--primary)">STISkilli</span> ‡§ï‡•á ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•à‡§Ç‡•§ <br>
                    ‡§Ü‡§™‡§ï‡•Ä ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§Ö‡§¨ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à!
                </div>
                <button class="res-btn" onclick="closeWelcome()">‡§ö‡§≤‡§ø‡§è ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç</button>
            </div>

            <div id="locked-popup" class="overlay-popup">
                <div class="res-emoji">üîí</div>
                <div id="lock-title" class="res-title" style="color:#ff1744;">‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§≤‡•â‡§ï ‡§π‡•à</div>
                <div id="lock-msg" class="welcome-text">
                    ‡§Ø‡§π ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•á‡§µ‡§≤ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§<br>
                    ‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§®‡§ø‡§ü‡•ç‡§∏ ‡§î‡§∞ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§Ö‡§™‡§ó‡•ç‡§∞‡•á‡§° ‡§ï‡§∞‡•á‡§Ç‡•§
                </div>
                <button id="lock-btn" class="res-btn" onclick="goToProfileFromLock()">‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç</button>
            </div>

            <div id="profile-section" style="display: none;">
                
                <div id="step-1" class="glass-panel">
                    <div style="width:70px; height:70px; background:rgba(0,0,0,0.5); border-radius:50%; border:2px solid var(--primary); display:flex; align-items:center; justify-content:center; margin-bottom:20px; box-shadow:0 0 20px var(--primary-glow);">
                        <i class="fas fa-crown" style="color:var(--primary); font-size:2rem;"></i>
                    </div>
                    <h2 style="font-family:'Rajdhani'; font-size:2rem; margin-bottom:5px; color:#fff; font-weight:800;">‡§è‡§≤‡•Ä‡§ü ‡§ï‡•ç‡§≤‡§¨ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç</h2>
                    <p style="color:#888; margin-bottom:25px; font-size:0.9rem;">‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                    
                    <form id="details-form" style="width:100%;">
                        <div class="gold-input-group">
                            <label class="gold-label">‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ</label>
                            <input type="text" id="user-name" class="gold-input" placeholder="‡§ú‡•à‡§∏‡•á: ‡§∞‡§æ‡§π‡•Å‡§≤ ‡§ï‡•Å‡§Æ‡§æ‡§∞" required>
                        </div>
                        <div class="gold-input-group">
                            <label class="gold-label">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</label>
                            <input type="tel" id="user-number" class="gold-input" placeholder="+91 XXXXX XXXXX" required>
                        </div>
                        <div class="gold-input-group">
                            <label class="gold-label">‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ</label>
                            <input type="email" id="user-email" class="gold-input" placeholder="naam@example.com" required>
                        </div>
                        <button type="submit" class="btn-pro">‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç ‡§™‡§∞ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç <i class="fas fa-arrow-right" style="margin-left:10px;"></i></button>
                    </form>
                </div>

                <div id="step-2" class="glass-panel" style="display:none; max-width:600px;">
                    <h2 style="font-family:'Rajdhani'; font-size:2rem; margin-bottom:20px; color:#fff; font-weight:800;">‡§™‡§π‡•Å‡§Ç‡§ö ‡§ö‡•Å‡§®‡•á‡§Ç</h2>
                    
                    <div class="plans-grid">
                        <div class="plan-card-pro" onclick="selectPlan(51, '1 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö', this)">
                            <div class="pc-check"><i class="fas fa-check-circle"></i></div>
                            <div class="pc-dur">1 ‡§Æ‡§π‡•Ä‡§®‡§æ</div>
                            <div class="pc-price">‚Çπ51</div>
                        </div>
                        <div class="plan-card-pro" onclick="selectPlan(101, '3 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö', this)">
                            <div class="pc-check"><i class="fas fa-check-circle"></i></div>
                            <div class="pc-dur">3 ‡§Æ‡§π‡•Ä‡§®‡•á</div>
                            <div class="pc-price">‚Çπ101</div>
                        </div>
                        <div class="plan-card-pro" onclick="selectPlan(151, '6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö', this)">
                            <div class="pc-check"><i class="fas fa-check-circle"></i></div>
                            <div class="pc-dur">6 ‡§Æ‡§π‡•Ä‡§®‡•á</div>
                            <div class="pc-price">‚Çπ151</div>
                        </div>
                        <div class="plan-card-pro" onclick="selectPlan(251, '1 ‡§µ‡§∞‡•ç‡§∑ ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö', this)">
                            <div class="pc-check"><i class="fas fa-check-circle"></i></div>
                            <div style="background:var(--primary); color:#000; font-size:0.6rem; padding:2px 6px; border-radius:4px; font-weight:800; margin-bottom:4px;">‡§¨‡•á‡§∏‡•ç‡§ü ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç</div>
                            <div class="pc-dur">1 ‡§µ‡§∞‡•ç‡§∑</div>
                            <div class="pc-price">‚Çπ251</div>
                        </div>
                    </div>

                    <div id="secret-code-section" style="display:none; width:100%; margin-bottom:15px;">
                        <input type="text" id="secret-code" class="gold-input" style="text-align:center; margin-bottom:10px;" placeholder="‡§ó‡•Å‡§™‡•ç‡§§ ‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                        <button id="secret-ok-btn" class="btn-pro" style="display:none;">‡§ï‡•ã‡§° ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
                    </div>
                    
                    <button id="go-to-pay-btn" class="btn-pro">‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§™‡§∞ ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•á‡§Ç</button>
                </div>

                <div id="step-3" class="glass-panel" style="display:none;">
                    <div style="width:60px; height:60px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; align-items:center; justify-content:center; margin-bottom:15px;">
                        <i class="fas fa-lock" style="font-size:1.5rem; color:#aaa;"></i>
                    </div>
                    <h2 style="font-family:'Rajdhani'; font-size:1.8rem; margin-bottom:5px; color:#fff;">‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®</h2>
                    <div style="font-size:0.9rem; color:#888; margin-bottom:20px;">‡§Ö‡§™‡§®‡§æ ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§á‡§∏‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç</div>
                    
                    <div id="final-price-display" style="font-size:2.5rem; color:var(--primary); font-family:'Rajdhani'; font-weight:800; margin-bottom:10px; text-shadow:0 0 20px rgba(244,196,48,0.3);">‚Çπ00.00</div>
                    <div id="timer" style="color:#fff; font-weight:bold; font-size:1.2rem; margin-bottom:30px; background:rgba(30,30,30,0.9); padding:8px 20px; border-radius:50px; border:1px solid #444;">05:00</div>
                    
                    <button id="rzp-button" class="btn-pro">‡§∞‡•õ‡•â‡§∞‡§™‡•á ‡§∏‡•á ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç</button>
                </div>

                <div id="step-4" style="display:none; width:100%; justify-content:center;">
                    <div class="dashboard-container">
                        
                        <div class="membership-card">
                            <div class="mc-header">
                                <div class="mc-chip"></div>
                                <div class="mc-plan-badge" id="disp-plan">‡§Ø‡•ã‡§ú‡§®‡§æ</div>
                            </div>
                            <div class="mc-user">
                                <div class="mc-name" id="disp-name">‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</div>
                                <div class="mc-email" id="disp-email">email@example.com</div>
                            </div>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-box">
                                <i class="fas fa-trophy sb-icon"></i>
                                <div class="sb-val" id="total-score-display">0</div>
                                <div class="sb-label">‡§ï‡•Å‡§≤ ‡§Ö‡§Ç‡§ï</div>
                            </div>
                            <div class="stat-box">
                                <i class="fas fa-chart-line sb-icon"></i>
                                <div class="sb-val" id="units-played-display">0</div>
                                <div class="sb-label">‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§Ø‡•Ç‡§®‡§ø‡§ü‡•ç‡§∏</div>
                            </div>
                        </div>

                        <div>
                            <div class="pro-progress-header"><span>‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§≤‡•â‡§ó</span> <i class="fas fa-chevron-down" style="font-size:0.8rem; opacity:0.5;"></i></div>
                            <div id="progress-container" style="padding-bottom:50px;">
                                </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        // --- 1. CONFIGURATION ---
        
        const APP_NAME = "STISkilli"; 
        
        // Editable Header Text for Stats Bar (User Request 2)
        const HEADER_TEXT = "MCQ";

        const CATEGORY_TITLES = {
            ancient: "‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏",   
            medieval: "‡§Æ‡§ß‡•ç‡§Ø‡§ï‡§æ‡§≤‡•Ä‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
            modern: "‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
            world: "‡§µ‡§ø‡§∂‡•ç‡§µ ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
            art: "‡§ï‡§≤‡§æ ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø",
            news: "‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§ñ‡•ã‡§ú‡•á‡§Ç",
            profile: "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤"
        };
        
        // --- SEQUENTIAL ORDER DEFINITION (User Request 3) ---
        const CATEGORY_ORDER = ['ancient', 'medieval', 'modern', 'world', 'art'];

        const categoryBackgrounds = {
            profile: 'skilligovtbck.png', ancient: 'anicianthistoryofindia.png', medieval: 'medivalhistoryofindia.png',
            modern: 'modernhistoryofindia.png', world: 'worldhistory.png', art: 'artandcultureofindia.png',
            news: 'skillinewsbck.png' 
        };

        const CHECKPOINT = 25;
        const PASS_REQ = 20;

        // --- 2. DATA ---
        const newsDatabase = [
            { tag: "‡§ñ‡•ã‡§ú", title: "‡§ó‡•Å‡§ú‡§∞‡§æ‡§§ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§π‡§°‡§º‡§™‡•ç‡§™‡§æ ‡§∏‡§æ‡§á‡§ü ‡§Æ‡§ø‡§≤‡•Ä", desc: "‡§™‡•Å‡§∞‡§æ‡§§‡§§‡•ç‡§µ‡§µ‡§ø‡§¶‡•ã‡§Ç ‡§®‡•á ‡§ß‡•ã‡§≤‡§æ‡§µ‡•Ä‡§∞‡§æ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§ï ‡§µ‡§ø‡§∂‡§æ‡§≤ ‡§¨‡§∏‡•ç‡§§‡•Ä ‡§ï‡•Ä ‡§ñ‡•Å‡§¶‡§æ‡§à ‡§ï‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§â‡§®‡•ç‡§®‡§§ ‡§®‡§æ‡§≤‡•Ä ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§ï‡§æ ‡§™‡§§‡§æ ‡§ö‡§≤‡§æ ‡§π‡•à‡•§", image: "skillinewsbck.png", link: "#" },
            { tag: "‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§®", title: "‡§∏‡§ø‡§Ç‡§ß‡•Å ‡§≤‡§ø‡§™‡§ø ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ã‡§° ‡§ï‡§∞‡§®‡§æ", desc: "AI ‡§Æ‡•â‡§°‡§≤ ‡§∏‡§ø‡§Ç‡§ß‡•Å ‡§ò‡§æ‡§ü‡•Ä ‡§∏‡§≠‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§Ö‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§®‡§è ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§∏‡•Å‡§ù‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§", image: "skillinewsbck.png", link: "#" },
            { tag: "‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ", title: "‡§µ‡§ø‡§∂‡•ç‡§µ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§∏‡§Æ‡•ç‡§Æ‡•á‡§≤‡§® 2026", desc: "‡§á‡§§‡§ø‡§π‡§æ‡§∏‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§á‡§∏ ‡§Æ‡§æ‡§∞‡•ç‡§ö ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡•Ä ‡§µ‡§∞‡•ç‡§ö‡•Å‡§Ö‡§≤ ‡§∏‡§≠‡§æ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç‡•§ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§™‡§π‡•Å‡§Ç‡§ö‡•§", image: "skillinewsbck.png", link: "#" },
            { tag: "‡§∞‡§π‡§∏‡•ç‡§Ø", title: "‡§®‡§æ‡§≤‡§Ç‡§¶‡§æ ‡§ï‡•Ä ‡§ñ‡•ã‡§à ‡§π‡•Å‡§à ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä", desc: "‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§® ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§µ‡§ø‡§∂‡§æ‡§≤ ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§®‡§∑‡•ç‡§ü ‡§π‡•Å‡§Ü ‡§î‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§¨‡§ö‡§æ ‡§π‡•à, ‡§á‡§∏ ‡§™‡§∞ ‡§ó‡§π‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£‡•§", image: "skillinewsbck.png", link: "#" }
        ];

        const quizDatabase = {
            ancient: [
                { 
                    name: "‡§∏‡§ø‡§Ç‡§ß‡•Å ‡§ò‡§æ‡§ü‡•Ä", questions: [ 
                        { q: "‡§∏‡§¨‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§µ‡•á‡§¶?", options: ["‡§ã‡§ó‡•ç‡§µ‡•á‡§¶", "‡§∏‡§æ‡§Æ‡§µ‡•á‡§¶", "‡§Ø‡§ú‡•Å‡§∞‡•ç‡§µ‡•á‡§¶", "‡§Ö‡§•‡§∞‡•ç‡§µ‡§µ‡•á‡§¶"], ans: 0, explanation: "‡§ã‡§ó‡•ç‡§µ‡•á‡§¶ ‡§∏‡§¨‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§µ‡•à‡§¶‡§ø‡§ï ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§ ‡§ó‡•ç‡§∞‡§Ç‡§• ‡§π‡•à‡•§ ‡§Ø‡§π 1,028 ‡§∏‡•Ç‡§ï‡•ç‡§§‡•ã‡§Ç ‡§î‡§∞ 10,600 ‡§∂‡•ç‡§≤‡•ã‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π ‡§π‡•à, ‡§ú‡•ã ‡§¶‡§∏ ‡§Æ‡§Ç‡§°‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡•§" }, 
                        { q: "‡§ó‡•ç‡§∞‡•á‡§ü ‡§¨‡§æ‡§• ‡§ï‡§π‡§æ‡§Å ‡§Æ‡§ø‡§≤‡§æ?", options: ["‡§π‡§°‡§º‡§™‡•ç‡§™‡§æ", "‡§Æ‡•ã‡§π‡§®‡§ú‡•ã‡§¶‡§°‡§º‡•ã", "‡§≤‡•ã‡§•‡§≤", "‡§ï‡§æ‡§≤‡•Ä‡§¨‡§Ç‡§ó‡§æ"], ans: 1, explanation: "‡§ó‡•ç‡§∞‡•á‡§ü ‡§¨‡§æ‡§• ‡§∏‡§ø‡§Ç‡§ß, ‡§™‡§æ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡•ã‡§π‡§®‡§ú‡•ã‡§¶‡§°‡§º‡•ã ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§ö‡•Ä‡§® ‡§∏‡§ø‡§Ç‡§ß‡•Å ‡§ò‡§æ‡§ü‡•Ä ‡§∏‡§≠‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§ñ‡§Ç‡§°‡§π‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï ‡§π‡•à‡•§" } 
                    ] 
                },
                { name: "‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø", questions: [ { q: "‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§ï‡•á ‡§≤‡•á‡§ñ‡§ï?", options: ["‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø", "‡§Æ‡•á‡§ó‡§∏‡•ç‡§•‡§®‡•Ä‡§ú", "‡§ï‡§æ‡§≤‡§ø‡§¶‡§æ‡§∏", "‡§Ö‡§∂‡•ã‡§ï"], ans: 0, explanation: "‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø, ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç ‡§ï‡•å‡§ü‡§ø‡§≤‡•ç‡§Ø ‡§Ø‡§æ ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å‡§ó‡•Å‡§™‡•ç‡§§ ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§≠‡•Ä ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§è‡§ï ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï, ‡§¶‡§æ‡§∞‡•ç‡§∂‡§®‡§ø‡§ï ‡§î‡§∞ ‡§∂‡§æ‡§π‡•Ä ‡§∏‡§≤‡§æ‡§π‡§ï‡§æ‡§∞ ‡§•‡•á ‡§ú‡§ø‡§®‡•ç‡§π‡•ã‡§Ç‡§®‡•á ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§ï‡•Ä ‡§∞‡§ö‡§®‡§æ ‡§ï‡•Ä‡•§" }, { q: "‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§µ‡§∞‡•ç‡§∑?", options: ["261 ‡§à‡§∏‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ", "273 ‡§à‡§∏‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ", "232 ‡§à‡§∏‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ", "240 ‡§à‡§∏‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ"], ans: 0, explanation: "‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß 261 ‡§à‡§∏‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ ‡§Æ‡•á‡§Ç ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§Ö‡§ß‡•Ä‡§® ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§î‡§∞ ‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§≤‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§" } ] }
            ],
            medieval: [
                { name: "‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§∏‡§≤‡•ç‡§§‡§®‡§§", questions: [ { q: "‡§ó‡•Å‡§≤‡§æ‡§Æ ‡§µ‡§Ç‡§∂ ‡§ï‡•á ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§™‡§ï?", options: ["‡§ê‡§¨‡§ï", "‡§á‡§≤‡•ç‡§§‡•Å‡§§‡§Æ‡§ø‡§∂", "‡§¨‡§≤‡§¨‡§®", "‡§∞‡§ú‡§ø‡§Ø‡§æ"], ans: 0, explanation: "‡§Æ‡•Å‡§π‡§Æ‡•ç‡§Æ‡§¶ ‡§ó‡§º‡•ã‡§∞‡•Ä ‡§ï‡•á ‡§è‡§ï ‡§ú‡§®‡§∞‡§≤, ‡§ï‡•Å‡§§‡•Å‡§¨ ‡§â‡§¶-‡§¶‡•Ä‡§® ‡§ê‡§¨‡§ï ‡§®‡•á 1206 ‡§Æ‡•á‡§Ç ‡§ó‡•Å‡§≤‡§æ‡§Æ ‡§µ‡§Ç‡§∂ (‡§Æ‡§æ‡§Æ‡§≤‡•Å‡§ï ‡§µ‡§Ç‡§∂) ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§æ‡§™‡§®‡§æ ‡§ï‡•Ä‡•§" }, { q: "‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£?", options: ["‡§Ö‡§≤‡§æ‡§â‡§¶‡•ç‡§¶‡•Ä‡§®", "‡§¨‡§≤‡§¨‡§®", "‡§´‡§º‡§ø‡§∞‡•ã‡§ú", "‡§Ö‡§ï‡§¨‡§∞"], ans: 0, explanation: "‡§Ö‡§≤‡§æ‡§â‡§¶‡•ç‡§¶‡•Ä‡§® ‡§ñ‡§ø‡§≤‡§ú‡•Ä ‡§®‡•á ‡§ï‡§Æ ‡§≤‡§æ‡§ó‡§§ ‡§™‡§∞ ‡§è‡§ï ‡§¨‡§°‡§º‡•Ä ‡§∏‡•á‡§®‡§æ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§ø‡§è, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§µ‡§∏‡•ç‡§§‡•Å‡§ì‡§Ç ‡§ï‡•Ä ‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç ‡§§‡§Ø ‡§ï‡•Ä ‡§ó‡§à‡§Ç‡•§" } ] },
                { name: "‡§Æ‡•Å‡§ó‡§º‡§≤", questions: [ { q: "‡§ê‡§®-‡§è-‡§Ö‡§ï‡§¨‡§∞‡•Ä ‡§ï‡•á ‡§≤‡•á‡§ñ‡§ï?", options: ["‡§Ö‡§¨‡•Å‡§≤ ‡§´‡§º‡§ú‡§º‡§≤", "‡§¨‡•Ä‡§∞‡§¨‡§≤", "‡§´‡•à‡§ú‡§º‡•Ä", "‡§ü‡•ã‡§°‡§∞"], ans: 0, explanation: "‡§ê‡§®-‡§è-‡§Ö‡§ï‡§¨‡§∞‡•Ä (‡§Ö‡§ï‡§¨‡§∞ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§®) ‡§Ö‡§¨‡•Å‡§≤ ‡§´‡§º‡§ú‡§º‡§≤ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§≤‡§ø‡§ñ‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ, ‡§ú‡•ã ‡§Æ‡•Å‡§ó‡§º‡§≤ ‡§∏‡§Æ‡•ç‡§∞‡§æ‡§ü ‡§Ö‡§ï‡§¨‡§∞ ‡§ï‡•á ‡§¶‡•Ä‡§µ‡§æ‡§® ‡§•‡•á‡•§" }, { q: "‡§π‡§≤‡•ç‡§¶‡•Ä‡§ò‡§æ‡§ü‡•Ä ‡§µ‡§∞‡•ç‡§∑?", options: ["1576", "1526", "1556", "1761"], ans: 0, explanation: "‡§π‡§≤‡•ç‡§¶‡•Ä‡§ò‡§æ‡§ü‡•Ä ‡§ï‡§æ ‡§Ø‡•Å‡§¶‡•ç‡§ß 18 ‡§ú‡•Ç‡§® 1576 ‡§ï‡•ã ‡§Æ‡§π‡§æ‡§∞‡§æ‡§£‡§æ ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§î‡§∞ ‡§Æ‡•Å‡§ó‡§º‡§≤ ‡§∏‡§Æ‡•ç‡§∞‡§æ‡§ü ‡§Ö‡§ï‡§¨‡§∞ ‡§ï‡•Ä ‡§∏‡•á‡§®‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§≤‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§" } ] }
            ],
            modern: [
                { name: "1857 ‡§ï‡§æ ‡§µ‡§ø‡§¶‡•ç‡§∞‡•ã‡§π", questions: [ { q: "1857 ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§?", options: ["‡§Æ‡•á‡§∞‡§†", "‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä", "‡§ï‡§æ‡§®‡§™‡•Å‡§∞", "‡§ù‡§æ‡§Å‡§∏‡•Ä"], ans: 0, explanation: "‡§µ‡§ø‡§¶‡•ç‡§∞‡•ã‡§π ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ 10 ‡§Æ‡§à 1857 ‡§ï‡•ã ‡§Æ‡•á‡§∞‡§† ‡§ï‡§∏‡•ç‡§¨‡•á ‡§Æ‡•á‡§Ç ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡•Ä ‡§∏‡•á‡§®‡§æ ‡§ï‡•á ‡§∏‡§ø‡§™‡§æ‡§π‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§µ‡§ø‡§¶‡•ç‡§∞‡•ã‡§π ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡•Å‡§à‡•§" }, { q: "‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§Æ‡•Å‡§ó‡§º‡§≤?", options: ["‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§∂‡§æ‡§π ‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø", "‡§î‡§∞‡§Ç‡§ó‡§ú‡§º‡•á‡§¨", "‡§∂‡§æ‡§π ‡§Ü‡§≤‡§Æ", "‡§Ö‡§ï‡§¨‡§∞ ‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø"], ans: 0, explanation: "‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§∂‡§æ‡§π ‡§ú‡§º‡§´‡§º‡§∞ (‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§∂‡§æ‡§π ‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø) ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§¨‡•Ä‡§∏‡§µ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§Æ‡•Å‡§ó‡§º‡§≤ ‡§∏‡§Æ‡•ç‡§∞‡§æ‡§ü ‡§•‡•á‡•§" } ] },
                { name: "‡§ó‡§æ‡§Å‡§ß‡•Ä ‡§Ø‡•Å‡§ó", questions: [ { q: "‡§ó‡§æ‡§Å‡§ß‡•Ä ‡§ï‡•Ä ‡§µ‡§æ‡§™‡§∏‡•Ä?", options: ["1915", "1917", "1919", "1920"], ans: 0, explanation: "‡§Æ‡§π‡§æ‡§§‡•ç‡§Æ‡§æ ‡§ó‡§æ‡§Ç‡§ß‡•Ä 9 ‡§ú‡§®‡§µ‡§∞‡•Ä 1915 ‡§ï‡•ã ‡§¶‡§ï‡•ç‡§∑‡§ø‡§£ ‡§Ö‡§´‡•ç‡§∞‡•Ä‡§ï‡§æ ‡§∏‡•á ‡§≠‡§æ‡§∞‡§§ ‡§≤‡•å‡§ü‡•á‡•§" }, { q: "‡§™‡§π‡§≤‡§æ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§ó‡•ç‡§∞‡§π?", options: ["‡§ö‡§Ç‡§™‡§æ‡§∞‡§£", "‡§ñ‡•á‡§°‡§º‡§æ", "‡§¶‡§æ‡§Ç‡§°‡•Ä", "‡§¨‡§æ‡§∞‡§¶‡•ã‡§≤‡•Ä"], ans: 0, explanation: "1917 ‡§ï‡§æ ‡§ö‡§Ç‡§™‡§æ‡§∞‡§£ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§ó‡•ç‡§∞‡§π ‡§≠‡§æ‡§∞‡§§ ‡§Æ‡•á‡§Ç ‡§ó‡§æ‡§Ç‡§ß‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡•á‡§§‡•É‡§§‡•ç‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§™‡§π‡§≤‡§æ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§ó‡•ç‡§∞‡§π ‡§Ü‡§Ç‡§¶‡•ã‡§≤‡§® ‡§•‡§æ‡•§" } ] }
            ],
            world: [
                { name: "‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß", questions: [ { q: "‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§∂‡•Å‡§∞‡•Ç?", options: ["1914", "1918", "1939", "1945"], ans: 0, explanation: "‡§Ü‡§∞‡•ç‡§ï‡§°‡•ç‡§Ø‡•Ç‡§ï ‡§´‡•ç‡§∞‡§æ‡§Ç‡§ú ‡§´‡§∞‡•ç‡§°‡§ø‡§®‡•á‡§Ç‡§° ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¨‡§æ‡§¶ 28 ‡§ú‡•Å‡§≤‡§æ‡§à 1914 ‡§ï‡•ã ‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•Å‡§Ü‡•§" }, { q: "‡§µ‡§∞‡•ç‡§∏‡§æ‡§Ø ‡§ï‡•Ä ‡§∏‡§Ç‡§ß‡§ø?", options: ["‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß", "‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß", "‡§∂‡•Ä‡§§ ‡§Ø‡•Å‡§¶‡•ç‡§ß", "‡§´‡•ç‡§∞‡•á‡§Ç‡§ö"], ans: 0, explanation: "‡§µ‡§∞‡•ç‡§∏‡§æ‡§Ø ‡§ï‡•Ä ‡§∏‡§Ç‡§ß‡§ø ‡§â‡§® ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§∏‡§Ç‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§•‡•Ä ‡§ú‡§ø‡§®‡•ç‡§π‡•ã‡§Ç‡§®‡•á ‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§µ ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§ï‡•ã ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ‡•§" } ] },
                { name: "‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø‡§Ø‡§æ‡§Å", questions: [ { q: "‡§´‡•ç‡§∞‡§æ‡§Ç‡§∏‡•Ä‡§∏‡•Ä ‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø?", options: ["1789", "1799", "1776", "1804"], ans: 0, explanation: "‡§´‡•ç‡§∞‡§æ‡§Ç‡§∏‡•Ä‡§∏‡•Ä ‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø ‡§Æ‡§à 1789 ‡§Æ‡•á‡§Ç ‡§è‡§∏‡•ç‡§ü‡•á‡§ü‡•ç‡§∏ ‡§ú‡§®‡§∞‡§≤ ‡§ë‡§´‡§º 1789 ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•Å‡§à‡•§" } ] }
            ],
            art: [
                { name: "‡§®‡•É‡§§‡•ç‡§Ø ‡§∞‡•Ç‡§™", questions: [ { q: "‡§≠‡§∞‡§§‡§®‡§æ‡§ü‡•ç‡§Ø‡§Æ?", options: ["‡§§‡§Æ‡§ø‡§≤ ‡§®‡§æ‡§°‡•Å", "‡§ï‡•á‡§∞‡§≤", "‡§Ü‡§Ç‡§ß‡•ç‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂", "‡§ì‡§°‡§ø‡§∂‡§æ"], ans: 0, explanation: "‡§≠‡§∞‡§§‡§®‡§æ‡§ü‡•ç‡§Ø‡§Æ ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§®‡•É‡§§‡•ç‡§Ø ‡§ï‡§æ ‡§è‡§ï ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§∞‡•Ç‡§™ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡•Ä ‡§â‡§§‡•ç‡§™‡§§‡•ç‡§§‡§ø ‡§§‡§Æ‡§ø‡§≤ ‡§®‡§æ‡§°‡•Å ‡§Æ‡•á‡§Ç ‡§π‡•Å‡§à ‡§•‡•Ä‡•§" }, { q: "‡§ï‡§•‡§ï‡§≤‡•Ä?", options: ["‡§ï‡•á‡§∞‡§≤", "‡§ï‡§∞‡•ç‡§®‡§æ‡§ü‡§ï", "‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂", "‡§Ö‡§∏‡§Æ"], ans: 0, explanation: "‡§ï‡§•‡§ï‡§≤‡•Ä ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§®‡•É‡§§‡•ç‡§Ø ‡§ï‡§æ ‡§è‡§ï ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§∞‡•Ç‡§™ ‡§π‡•à ‡§ú‡•ã ‡§Ö‡§™‡§®‡•á ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§Æ‡•á‡§ï‡§Ö‡§™ ‡§î‡§∞ ‡§µ‡•á‡§∂‡§≠‡•Ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§ï‡•Ä ‡§â‡§§‡•ç‡§™‡§§‡•ç‡§§‡§ø ‡§ï‡•á‡§∞‡§≤ ‡§Æ‡•á‡§Ç ‡§π‡•Å‡§à ‡§•‡•Ä‡•§" } ] },
                { name: "‡§∏‡§Ç‡§ó‡•Ä‡§§", questions: [ { q: "‡§π‡§ø‡§Ç‡§¶‡•Å‡§∏‡•ç‡§§‡§æ‡§®‡•Ä ‡§∏‡§¨‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡§æ?", options: ["‡§ß‡•ç‡§∞‡•Å‡§™‡§¶", "‡§ñ‡§º‡§Ø‡§æ‡§≤", "‡§†‡•Å‡§Æ‡§∞‡•Ä", "‡§ó‡§º‡§ú‡§º‡§≤"], ans: 0, explanation: "‡§ß‡•ç‡§∞‡•Å‡§™‡§¶ ‡§π‡§ø‡§Ç‡§¶‡•Å‡§∏‡•ç‡§§‡§æ‡§®‡•Ä ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§∏‡§Ç‡§ó‡•Ä‡§§ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§ú‡•Ä‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§π‡•à‡•§" } ] }
            ]
        };

        // --- 3. STATE MANAGEMENT ---
        let userData = {
            name: localStorage.getItem('userName') || '',
            number: localStorage.getItem('userMobile') || '',
            email: localStorage.getItem('userEmail') || '',
            txn: localStorage.getItem('userTxn') || '',
            planAmount: localStorage.getItem('userPlanAmount') || '',
            planName: localStorage.getItem('userPlanName') || ''
        };
        
        let selectedPlanPrice = 0, selectedPlanLabel = "";
        
        let progressData;
        try { progressData = JSON.parse(localStorage.getItem('quizProgress')) || {}; } catch(e) { progressData = {}; }

        // Level Tracking (Units inside Categories)
        let unlockedLevels;
        try { unlockedLevels = JSON.parse(localStorage.getItem('unlockedLevels')) || { ancient: 1, medieval: 1, modern: 1, world: 1, art: 1 }; } catch (e) { unlockedLevels = { ancient: 1, medieval: 1, modern: 1, world: 1, art: 1 }; }

        // Category Tracking (Global Categories) - NEW for Sequential Logic
        let completedCategories;
        try { completedCategories = JSON.parse(localStorage.getItem('completedCategories')) || []; } catch(e) { completedCategories = []; }

        let activeCat = "", activeUnitIdx = 0;
        let currentSession = { score: 0, correct: 0, wrong: 0, qIndex: 0 };
        let blockCorrect = 0; 
        let questionTimer;
        let timeLeft = 30;

        function hasPaid() { return localStorage.getItem('hasPaid') === 'true'; }

        // --- 4. NAVIGATION & SEQUENTIAL LOGIC ---
        
        // Helper to check if a category is accessible
        function isCategoryAccessible(catName) {
            if (catName === 'ancient') return true; // First one always open (if paid)
            
            const catIndex = CATEGORY_ORDER.indexOf(catName);
            if (catIndex <= 0) return true;

            const prevCat = CATEGORY_ORDER[catIndex - 1];
            return completedCategories.includes(prevCat);
        }

        // Helper to update Dock Icons visuals based on lock state
        function updateDockIcons() {
            if (!hasPaid()) return; 

            CATEGORY_ORDER.forEach(cat => {
                const el = document.getElementById(`nav-${cat}`);
                if (!el) return;

                // Remove existing badge if any
                const existingBadge = el.querySelector('.lock-badge');
                if(existingBadge) existingBadge.remove();

                if (!isCategoryAccessible(cat)) {
                    el.classList.add('cat-locked');
                    // Add lock badge
                    const badge = document.createElement('div');
                    badge.className = 'lock-badge';
                    badge.innerHTML = '<i class="fas fa-lock"></i>';
                    el.appendChild(badge);
                } else {
                    el.classList.remove('cat-locked');
                }
            });
        }

        function openCategory(catName, btnElement) {
            if(questionTimer) clearInterval(questionTimer);

            // 1. Payment Check (Hard Gate)
            if (catName !== 'profile' && !hasPaid()) {
                document.getElementById('lock-title').innerText = "‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§≤‡•â‡§ï ‡§π‡•à";
                document.getElementById('lock-msg').innerHTML = "‡§Ø‡§π ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•á‡§µ‡§≤ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§<br>‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§Ö‡§™‡§ó‡•ç‡§∞‡•á‡§° ‡§ï‡§∞‡•á‡§Ç‡•§";
                document.getElementById('lock-btn').innerText = "‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç";
                document.getElementById('lock-btn').onclick = () => goToProfileFromLock();
                document.getElementById('locked-popup').style.display = 'flex';
                return;
            }

            // 2. Sequential Category Check (The "Most Important" Logic)
            if (catName !== 'profile' && catName !== 'news') {
                if (!isCategoryAccessible(catName)) {
                    // Find previous category name
                    const idx = CATEGORY_ORDER.indexOf(catName);
                    const prevCat = CATEGORY_ORDER[idx - 1];
                    const prevTitle = CATEGORY_TITLES[prevCat];

                    document.getElementById('lock-title').innerText = "‡§Ø‡•Å‡§ó ‡§≤‡•â‡§ï ‡§π‡•à";
                    document.getElementById('lock-msg').innerHTML = `‡§á‡§∏ ‡§Ø‡•Å‡§ó ‡§ï‡•ã ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã <br><span class="user-highlight">${prevTitle}</span><br> ‡§ï‡•Ä ‡§∏‡§≠‡•Ä ‡§Ø‡•Ç‡§®‡§ø‡§ü‡•ç‡§∏ ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡§∞‡§®‡•Ä ‡§π‡•ã‡§Ç‡§ó‡•Ä‡•§`;
                    document.getElementById('lock-btn').innerText = prevTitle + " ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç";
                    document.getElementById('lock-btn').onclick = () => {
                        document.getElementById('locked-popup').style.display = 'none';
                        openCategory(prevCat, document.getElementById(`nav-${prevCat}`));
                    };
                    document.getElementById('locked-popup').style.display = 'flex';
                    return;
                }
            }

            if (btnElement) {
                document.querySelectorAll('.dock-item').forEach(el => el.classList.remove('active'));
                btnElement.classList.add('active');
            }

            const modalBox = document.getElementById('dynamic-modal-box');
            modalBox.style.backgroundImage = `url('${categoryBackgrounds[catName] || 'skilligovtbck.png'}')`;
            
            let dispTitle = CATEGORY_TITLES[catName] || catName.toUpperCase();
            document.getElementById('cat-title').innerText = dispTitle;

            const quizUI = document.getElementById('quiz-interface');
            const profileUI = document.getElementById('profile-section');
            const newsUI = document.getElementById('news-section');
            const subNav = document.getElementById('sub-nav-container');

            quizUI.style.display = 'none';
            profileUI.style.display = 'none';
            newsUI.style.display = 'none';
            subNav.style.display = 'none';
            document.getElementById('result-overlay').style.display = 'none';
            document.getElementById('category-unlock-popup').style.display = 'none';
            document.getElementById('locked-popup').style.display = 'none';
            document.getElementById('explanation-overlay').style.display = 'none'; 

            if (catName === 'profile') {
                profileUI.style.display = 'flex';
                initProfileView();
            } else if (catName === 'news') {
                newsUI.style.display = 'flex';
                renderNews();
            } else {
                quizUI.style.display = 'flex';
                subNav.style.display = 'flex';
                activeCat = catName;
                // Set the static Header Text
                document.getElementById('static-header-text').innerText = HEADER_TEXT;
                
                renderSubNav(catName);
                switchUnit(0, document.getElementById(`sub-unit-0`)); 
            }
        }

        function renderNews() {
            const feed = document.getElementById('news-feed');
            feed.innerHTML = '';
            
            newsDatabase.forEach(item => {
                const card = document.createElement('div');
                card.className = 'news-card';
                card.innerHTML = `
                    <img src="${item.image}" class="news-img" alt="‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞">
                    <div class="news-body">
                        <div class="news-tag">${item.tag}</div>
                        <div class="news-title">${item.title}</div>
                        <div class="news-desc">${item.desc}</div>
                        <a href="${item.link}" class="news-btn">‡§™‡•Ç‡§∞‡•Ä ‡§ï‡§π‡§æ‡§®‡•Ä ‡§™‡§¢‡§º‡•á‡§Ç <i class="fas fa-arrow-right"></i></a>
                    </div>
                `;
                feed.appendChild(card);
            });
        }

        function renderSubNav(catName) {
            const container = document.getElementById('sub-nav-container');
            const units = quizDatabase[catName];
            
            if(!units) {
                container.innerHTML = '<div style="color:#aaa; padding:10px;">‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§Ü ‡§∞‡§π‡§æ ‡§π‡•à</div>';
                document.getElementById('q-text').innerText = "‡§á‡§∏ ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§";
                document.getElementById('options-list').innerHTML = '';
                return;
            }

            if (!unlockedLevels[catName]) unlockedLevels[catName] = 1;
            const maxLvl = unlockedLevels[catName];
            
            container.innerHTML = units.map((u, i) => {
                const isLocked = (i + 1) > maxLvl;
                return `<div class="sub-item ${isLocked?'locked':''}" id="sub-unit-${i}" ${isLocked?'':`onclick="switchUnit(${i}, this)"`}>${u.name} ${isLocked?'<i class="fas fa-lock"></i>':''}</div>`;
            }).join('');
        }

        function switchUnit(idx, el) {
            idx = parseInt(idx);
            
            if(!el && document.getElementById(`sub-unit-${idx}`)) el = document.getElementById(`sub-unit-${idx}`);
            if(el) {
                document.querySelectorAll('.sub-item').forEach(e => e.classList.remove('active'));
                el.classList.add('active');
            }
            startQuiz(idx);
        }

        // --- 5. QUIZ ENGINE ---
        function startQuiz(idx) {
            if(questionTimer) clearInterval(questionTimer);
            activeUnitIdx = idx;
            document.getElementById('result-overlay').style.display = 'none';
            document.getElementById('explanation-overlay').style.display = 'none';
            
            if(!quizDatabase[activeCat] || !quizDatabase[activeCat][idx]) {
                document.getElementById('q-text').innerText = "‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§";
                return;
            }
            
            // Note: unit name is no longer displayed in stats bar per request, only in sub-nav.
            
            if (!progressData[activeCat]) progressData[activeCat] = {};
            if (!progressData[activeCat][idx]) {
                progressData[activeCat][idx] = { score: 0, correct: 0, wrong: 0, qIndex: 0, blockCorrect: 0, order: [] };
            }
            
            currentSession = progressData[activeCat][idx];
            blockCorrect = currentSession.blockCorrect || 0; 

            const totalQuestions = quizDatabase[activeCat][idx].questions.length;
            if(!currentSession.order || currentSession.order.length !== totalQuestions) {
                currentSession.order = Array.from({length: totalQuestions}, (_, i) => i);
                for (let i = currentSession.order.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [currentSession.order[i], currentSession.order[j]] = [currentSession.order[j], currentSession.order[i]];
                }
                saveProgress();
            }
            
            loadQuestion();
        }

        function loadQuestion() {
            if(questionTimer) clearInterval(questionTimer);
            
            try {
                if(!quizDatabase[activeCat] || !quizDatabase[activeCat][activeUnitIdx]) return;
                
                const db = quizDatabase[activeCat][activeUnitIdx].questions;
                if(!db || db.length === 0) {
                    document.getElementById('q-text').innerText = "‡§á‡§∏ ‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§";
                    return;
                }

                const shuffledIndex = currentSession.order[currentSession.qIndex % db.length];
                const actualQ = db[shuffledIndex];
                
                const displayNum = currentSession.qIndex + 1;
                // Cap the display limit at actual available questions if less than CHECKPOINT
                const currentBatchLimit = Math.min(db.length, CHECKPOINT * (Math.floor(currentSession.qIndex/CHECKPOINT) + 1));
                
                document.getElementById('q-num-display').innerText = `${displayNum} / ${currentBatchLimit}`;
                document.getElementById('q-text').innerText = actualQ.q;

                const list = document.getElementById('options-list');
                list.innerHTML = '';
                actualQ.options.forEach((opt, i) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-btn';
                    btn.innerHTML = `<span>${opt}</span> <i class="far fa-circle"></i>`;
                    btn.onclick = () => handleAnswer(i, actualQ.ans, btn, actualQ);
                    list.appendChild(btn);
                });

                startTimerLogic(actualQ.ans, actualQ);

            } catch (error) {
                console.error("Error loading question:", error);
                document.getElementById('q-text').innerText = "‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...";
                currentSession = { score: 0, correct: 0, wrong: 0, qIndex: 0, blockCorrect: 0, order: [] };
                saveProgress();
                setTimeout(() => startQuiz(activeUnitIdx), 1500);
            }
        }

        function startTimerLogic(correctIndex, qObj) {
            timeLeft = 30;
            document.getElementById('q-timer').innerText = timeLeft;
            
            questionTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('q-timer').innerText = timeLeft;
                if(timeLeft <= 0) {
                    clearInterval(questionTimer);
                    handleTimeOut(correctIndex, qObj);
                }
            }, 1000);
        }

        function handleTimeOut(correctIndex, qObj) {
            document.querySelectorAll('.option-btn').forEach(b => b.onclick = null);
            const btns = document.querySelectorAll('.option-btn');
            if(btns[correctIndex]) btns[correctIndex].classList.add('correct');
            
            currentSession.score -= 0.25;
            currentSession.wrong++;
            currentSession.qIndex++;
            currentSession.blockCorrect = blockCorrect;
            saveProgress();
            
            setTimeout(() => {
                showExplanation(false, qObj);
            }, 800);
        }

        function handleAnswer(sel, cor, btn, qObj) {
            clearInterval(questionTimer);
            document.querySelectorAll('.option-btn').forEach(b => b.onclick = null);

            let isCorrect = false;

            if(sel === cor) {
                btn.classList.add('correct');
                currentSession.score += 2;
                currentSession.correct++;
                blockCorrect++;
                isCorrect = true;
            } else {
                btn.classList.add('wrong');
                currentSession.score -= 0.25;
                currentSession.wrong++;
                const allBtns = document.querySelectorAll('.option-btn');
                if(allBtns[cor]) allBtns[cor].classList.add('correct');
                isCorrect = false;
            }

            currentSession.qIndex++;
            currentSession.blockCorrect = blockCorrect;
            saveProgress();

            setTimeout(() => {
                showExplanation(isCorrect, qObj);
            }, 800);
        }

        // --- EXPLANATION FUNCTIONS ---
        function showExplanation(isCorrect, qObj) {
            const overlay = document.getElementById('explanation-overlay');
            const icon = document.getElementById('expl-icon');
            const title = document.getElementById('expl-title');
            const text = document.getElementById('expl-text');
            const box = document.getElementById('expl-box');

            const explanation = qObj.explanation || "‡§á‡§∏ ‡§â‡§§‡•ç‡§§‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§ê‡§§‡§ø‡§π‡§æ‡§∏‡§ø‡§ï ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§";

            if(isCorrect) {
                icon.innerHTML = "";
                title.innerText = "‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞";
                title.style.color = "var(--correct)";
                box.style.borderColor = "var(--correct)";
                box.style.boxShadow = "0 0 30px rgba(0, 230, 118, 0.2)";
            } else {
                icon.innerHTML = "";
                title.innerText = "‡§ó‡§º‡§≤‡§§";
                title.style.color = "var(--wrong)";
                box.style.borderColor = "var(--wrong)";
                box.style.boxShadow = "0 0 30px rgba(255, 23, 68, 0.2)";
            }

            // Scroll to top of explanation when opening new one
            text.innerText = explanation;
            text.scrollTop = 0; 
            
            overlay.style.display = 'flex';
        }

        function closeExplanationAndNext() {
            document.getElementById('explanation-overlay').style.display = 'none';
            checkResultOrNext();
        }

        function checkResultOrNext() {
            if (currentSession.qIndex > 0 && currentSession.qIndex % CHECKPOINT === 0) {
                showResultPopup();
            } else {
                loadQuestion();
            }
        }

        function saveProgress() {
            if (!progressData[activeCat]) progressData[activeCat] = {};
            progressData[activeCat][activeUnitIdx] = currentSession;
            localStorage.setItem('quizProgress', JSON.stringify(progressData));
        }

        // --- SUCCESS LOGIC WITH SEQUENTIAL UNLOCKING ---
        function showResultPopup() {
            const overlay = document.getElementById('result-overlay');
            const emoji = document.getElementById('res-emoji');
            const title = document.getElementById('res-title');
            const btn = document.getElementById('res-btn');
            const failMsg = document.getElementById('fail-msg');

            document.getElementById('final-score').innerText = currentSession.score.toFixed(2);
            document.getElementById('correct-count').innerText = `${blockCorrect} / ${CHECKPOINT}`;

            if (blockCorrect >= PASS_REQ) {
                // USER PASSED A BLOCK/UNIT
                
                // 1. Check if we need to unlock next UNIT within current category
                const totalUnits = quizDatabase[activeCat].length;
                if(activeUnitIdx + 1 === unlockedLevels[activeCat] && unlockedLevels[activeCat] < totalUnits) {
                    unlockedLevels[activeCat]++;
                    localStorage.setItem('unlockedLevels', JSON.stringify(unlockedLevels));
                    renderSubNav(activeCat);
                }

                // 2. Check if this was the LAST UNIT of the category (Unlock Next Category)
                const isLastUnit = (activeUnitIdx + 1) === totalUnits;
                
                if (isLastUnit) {
                    // Logic to unlock next Category
                    if (!completedCategories.includes(activeCat)) {
                        completedCategories.push(activeCat);
                        localStorage.setItem('completedCategories', JSON.stringify(completedCategories));
                        updateDockIcons(); // Update lock icons visual
                        
                        // Show Special Category Unlock Popup
                        const nextCatIndex = CATEGORY_ORDER.indexOf(activeCat) + 1;
                        if (nextCatIndex < CATEGORY_ORDER.length) {
                            const nextCatKey = CATEGORY_ORDER[nextCatIndex];
                            document.getElementById('completed-cat-name').innerText = CATEGORY_TITLES[activeCat];
                            document.getElementById('unlocked-cat-name').innerText = CATEGORY_TITLES[nextCatKey];
                            
                            // Configure button to go to next category
                            btn.onclick = null; // Prevent standard behavior
                            document.getElementById('category-unlock-popup').style.display = 'flex';
                            return; // Stop standard popup
                        }
                    }
                }

                // Standard Success Popup
                emoji.innerText = "üéâ";
                title.innerText = "‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§™‡§æ‡§∏!";
                title.style.color = "#00e676";
                failMsg.style.display = "none";
                btn.innerText = isLastUnit ? "‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ñ‡•á‡§≤‡•á‡§Ç" : "‡§Ö‡§ó‡§≤‡•Ä ‡§Ø‡•Ç‡§®‡§ø‡§ü";
                
                btn.onclick = () => {
                    if (isLastUnit) {
                        // Just reset current
                        blockCorrect = 0; currentSession.blockCorrect = 0; saveProgress(); overlay.style.display = 'none'; loadQuestion();
                    } else {
                        // Go to next unit automatically
                        overlay.style.display = 'none';
                        switchUnit(activeUnitIdx + 1);
                    }
                };

            } else {
                // FAILED
                emoji.innerText = "üò¢";
                title.innerText = "‡§´‡•á‡§≤!";
                title.style.color = "#ff1744";
                failMsg.style.display = "block";
                btn.innerText = "‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç";
                btn.onclick = () => {
                    currentSession.qIndex = 0; 
                    currentSession.score = 0; 
                    currentSession.correct = 0; 
                    currentSession.wrong = 0; 
                    currentSession.order = []; 
                    blockCorrect = 0;
                    saveProgress(); 
                    overlay.style.display = 'none'; 
                    startQuiz(activeUnitIdx); 
                };
            }
            overlay.style.display = 'flex';
        }

        function closeCategoryUnlock() {
            document.getElementById('category-unlock-popup').style.display = 'none';
            // Auto navigate to next category
            const nextCatIndex = CATEGORY_ORDER.indexOf(activeCat) + 1;
            if (nextCatIndex < CATEGORY_ORDER.length) {
                const nextCatKey = CATEGORY_ORDER[nextCatIndex];
                openCategory(nextCatKey, document.getElementById(`nav-${nextCatKey}`));
            }
        }

        // --- 6. PROFILE & PAYMENTS ---
        function initProfileView() {
            if (hasPaid()) {
                showStep(4);
                document.getElementById('disp-name').innerText = userData.name;
                document.getElementById('disp-email').innerText = userData.email;
                document.getElementById('disp-plan').innerText = userData.planName;
                renderProgressReport();
            } else { showStep(1); }
        }

        function renderProgressReport() {
            const container = document.getElementById('progress-container');
            container.innerHTML = '';
            let hasData = false;
            let grandTotal = 0;
            let unitsPlayed = 0;

            for (const cat in progressData) {
                if(!quizDatabase[cat]) continue;
                
                const displayCategoryName = CATEGORY_TITLES[cat] || cat.toUpperCase();

                for (const uIdx in progressData[cat]) {
                    const d = progressData[cat][uIdx];
                    if(d.qIndex > 0) {
                        hasData = true;
                        unitsPlayed++;
                        grandTotal += d.score;

                        const total = d.correct + d.wrong;
                        const correctPct = total === 0 ? 0 : (d.correct / total) * 100;
                        const unitObj = quizDatabase[cat][uIdx];
                        const uName = unitObj ? unitObj.name : `‡§Ø‡•Ç‡§®‡§ø‡§ü ${parseInt(uIdx)+1}`;
                        
                        container.innerHTML += `
                        <div class="pp-item">
                            <div class="pp-top">
                                <span class="pp-title">${displayCategoryName} / ${uName}</span>
                                <span class="pp-score">${d.score.toFixed(1)} ‡§Ö‡§Ç‡§ï</span>
                            </div>
                            <div class="pp-bar-bg">
                                <div class="pp-bar-fill" style="width:${correctPct}%"></div>
                            </div>
                            <div class="pp-meta">
                                <span><i class="fas fa-check" style="color:var(--correct)"></i> ${d.correct}</span>
                                <span><i class="fas fa-times" style="color:var(--wrong)"></i> ${d.wrong}</span>
                            </div>
                        </div>`;
                    }
                }
            }
            if(!hasData) container.innerHTML = '<div style="color:#555; text-align:center; padding-top:20px;">‡§ï‡•ã‡§à ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§è‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç!</div>';
            
            try {
                document.getElementById('total-score-display').innerText = grandTotal.toFixed(0);
                document.getElementById('units-played-display').innerText = unitsPlayed;
            } catch(e) {}
        }

        function goToProfileFromLock() {
            document.getElementById('locked-popup').style.display = 'none';
            openCategory('profile', document.getElementById('nav-profile'));
        }

        function showStep(n) { [1,2,3,4].forEach(i=>document.getElementById(`step-${i}`).style.display='none'); document.getElementById(`step-${n}`).style.display = (n===4?'flex':'flex'); }

        document.getElementById('details-form').addEventListener('submit', (e) => {
            e.preventDefault();
            userData.name = document.getElementById('user-name').value;
            userData.number = document.getElementById('user-number').value;
            userData.email = document.getElementById('user-email').value;
            const last = userData.name.toLowerCase().split(' ').pop();
            if(['insa','insha','insan'].includes(last)) { 
                document.getElementById('secret-code-section').style.display='block'; 
                document.getElementById('go-to-pay-btn').style.display='none'; 
            }
            showStep(2);
        });

        function selectPlan(p, l, el) { selectedPlanPrice=p; selectedPlanLabel=l; document.querySelectorAll('.plan-card-pro').forEach(c=>c.classList.remove('selected')); el.classList.add('selected'); }
        
        document.getElementById('secret-code').addEventListener('input', (e)=>{ if(e.target.value==='MSGMSGMSG') document.getElementById('secret-ok-btn').style.display='block'; });
        document.getElementById('secret-ok-btn').addEventListener('click', ()=>{ userData.planName='‡§≤‡§æ‡§á‡§´‡§ü‡§æ‡§á‡§Æ VIP'; userData.txn='MSG-FREE'; userData.planAmount='0'; sendToSheet(); completeTxn(); });

        document.getElementById('go-to-pay-btn').addEventListener('click', () => {
            if(!selectedPlanPrice) return alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§");
            document.getElementById('final-price-display').innerText = `‚Çπ${selectedPlanPrice}.00`;
            showStep(3); startTimer();
        });

        let tInt;
        function startTimer() { 
            let t=300; 
            if(tInt) clearInterval(tInt); 
            tInt=setInterval(()=>{ 
                let m=Math.floor(t/60),s=t%60; 
                document.getElementById('timer').innerText=`${m}:${s<10?'0'+s:s}`; 
                t--; 
                if(t<0) { clearInterval(tInt); alert("‡§∏‡§Æ‡§Ø ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§"); showStep(1); } 
            },1000); 
        }

        document.getElementById('rzp-button').addEventListener('click', () => {
            const rzp = new Razorpay({
                key: "rzp_live_zyUA84YdEZR7rO", amount: selectedPlanPrice*100, currency: "INR",
                name: "SKILLI PRO", description: selectedPlanLabel,
                handler: function(r){ 
                    userData.txn=r.razorpay_payment_id; 
                    userData.planAmount=selectedPlanPrice; 
                    userData.planName=selectedPlanLabel; 
                    sendToSheet();
                    completeTxn(); 
                },
                prefill: { name: userData.name, email: userData.email, contact: userData.number }, theme: { color: "#F4C430" }
            });
            rzp.open();
        });

        async function sendToSheet() {
            const url = 'https://script.google.com/macros/s/AKfycbxOET0tOiJTHgYVDlBWyz6-rAHMQqd32_ezqmQa13HSQv-DVo3ZvQtNppPZgHcISApXhw/exec';
            const fd = new FormData();
            fd.append('name', userData.name);
            fd.append('number', userData.number);
            fd.append('email', userData.email);
            fd.append('amount', userData.planAmount);
            fd.append('plan_name', userData.planName);
            fd.append('transaction_id', userData.txn);
            try { await fetch(url, { method:'POST', body:fd }); } catch(e){ console.log(e); }
        }

        function completeTxn() {
            if(tInt) clearInterval(tInt);
            localStorage.setItem('hasPaid','true'); 
            localStorage.setItem('userName',userData.name);
            localStorage.setItem('userEmail',userData.email);
            localStorage.setItem('userTxn',userData.txn); 
            localStorage.setItem('userPlanName',userData.planName);
            
            // Re-render visual locks
            updateDockIcons();
            
            document.getElementById('wel-user').innerText = userData.name;
            document.getElementById('welcome-popup').style.display = 'flex';
        }

        function closeWelcome() {
            document.getElementById('welcome-popup').style.display = 'none';
            initProfileView();
        }

        window.addEventListener('DOMContentLoaded', () => {
            document.getElementById('app-main-title').innerText = APP_NAME;
            document.title = APP_NAME + " - ‡§™‡•ç‡§∞‡•ã";
            
            updateDockIcons();

            if(hasPaid()) openCategory('ancient', document.getElementById('nav-ancient'));
            else openCategory('profile', document.getElementById('nav-profile'));
        });
    </script>
</body>
</html>
