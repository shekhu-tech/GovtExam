<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crapd.in - All-Government-Job-Full-Flash-Guidance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111;
        }

        .golden-text-gradient {
            background-image: linear-gradient(180deg, #FFD700, #FFC107, #B8860B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .golden-border {
            border: 2px solid;
            border-image: linear-gradient(135deg, #FFD700, #B8860B, #FFD700) 1;
        }

        .golden-shadow {
            box-shadow: 0 4px 6px -1px rgba(255, 215, 0, 0.1), 0 2px 4px -1px rgba(255, 215, 0, 0.06);
        }

        .popup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .popup-content {
            background-color: #1a1a1a;
            color: #FFD700;
            padding: 1.5rem;
            border-radius: 1.5rem;
            max-width: 95%;
            width: auto;
            min-width: 300px;
            margin: 0 1rem;
            text-align: center;
            border: 3px solid #FFD700;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.5);
            animation: fadeInScale 0.5s ease-out forwards;
            max-height: 90vh; /* Ultra pro max height */
            overflow-y: auto; /* Scrollable content */
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .input-field {
            background-color: #2a2a2a;
            border: 2px solid #FFC107;
            color: white;
        }

        .input-field:focus {
            outline: none;
            border-color: #FFD700;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.5);
        }

        .button {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(255, 215, 0, 0.3);
        }

        .button:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FFD700;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .text-left {
            text-align: left;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        @media (max-width: 375px) {
            .popup-content {
                padding: 1rem;
            }

            .text-2xl {
                font-size: 1.25rem;
            }

            .text-3xl {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">

    <!-- Step 1: User Details Form -->
    <div id="popup-step-1" class="popup-container">
        <div class="popup-content golden-border">
            <h2 id="step-1-heading" class="text-2xl sm:text-3xl font-bold mb-4 golden-text-gradient drop-shadow-lg">
                <span class="golden-text-gradient">Abhi Shuru Karen!</span>
            </h2>
            <form id="form-step-1" class="space-y-4">
                <div>
                    <input type="text" id="name" name="name" placeholder="Aapka Pyaara Naam" required class="w-full p-3 rounded-lg input-field">
                </div>
                <div>
                    <input type="tel" id="number" name="number" placeholder="Aapka Number" required class="w-full p-3 rounded-lg input-field">
                </div>
                <div>
                    <input type="email" id="email" name="email" placeholder="Aapka Email" required class="w-full p-3 rounded-lg input-field">
                </div>
                <button type="submit" id="next-button" class="w-full px-6 py-3 mt-6 text-xl font-bold text-gray-900 bg-amber-500 rounded-lg shadow-xl button hover:bg-amber-400">
                    Next
                </button>
            </form>
        </div>
    </div>

    <!-- Step 2: Service Details and Price -->
    <div id="popup-step-2" class="popup-container">
        <div class="popup-content golden-border text-left">
            <h2 class="text-2xl sm:text-3xl font-bold mb-4 golden-text-gradient drop-shadow-lg text-center">
                Abhi Khareedein Aur Safalta Ki Raah Par Chalein
            </h2>
            <ul class="text-gray-300 text-sm md:text-base leading-relaxed mb-6 space-y-3">
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>All Government Job ki Poori Guide.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Video Lectures ki Exclusive Playlist.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Notes teen bhaashao mein: Hindi, English, aur Punjabi.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>WhatsApp support.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Call support.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>UPSC jaisi sabhi services ki poori jaankari.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Apne sapne ko sach karen.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Samay bachayen aur tezi se taiyari karen.</span>
                </li>
                <li class="flex items-start">
                    <svg class="h-6 w-6 text-amber-500 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    <span>Bharat ki har sarkari naukri ka ek solution.</span>
                </li>
            </ul>
            <div id="secret-code-section" class="mt-8 hidden">
                <input type="text" id="secret-code" placeholder="Secret Code Daalein" class="w-full p-3 rounded-lg input-field text-center">
            </div>

            <p id="payment-text" class="text-xl sm:text-2xl font-bold golden-text-gradient mb-4 text-center">Sirf ₹77 mein, ye sab paayen!</p>
            <button id="pay-button" class="w-full px-6 py-3 mt-4 text-xl font-bold text-gray-900 bg-amber-500 rounded-lg shadow-xl button hover:bg-amber-400">
                Pay ₹77
            </button>
            <button id="secret-okay-button" class="w-full px-6 py-3 mt-4 text-xl font-bold text-gray-900 bg-amber-500 rounded-lg shadow-xl button hover:bg-amber-400 hidden">
                Okay
            </button>
        </div>
    </div>

    <!-- Step 3: Payment Gateway (newly added) -->
    <div id="popup-step-3-payment" class="popup-container">
        <div class="popup-content golden-border">
            <h2 class="text-2xl font-bold text-center mb-4 golden-text-gradient">Complete Your Payment</h2>
            <p id="payment-summary" class="text-gray-300 text-center mb-6"></p>
            <div id="timerDisplay" class="text-white text-lg font-bold text-center mb-4">Time remaining: 05:00</div>
            <button id="razorpay-payment-btn" class="w-full px-6 py-3 mt-4 text-xl font-bold text-gray-900 bg-amber-500 rounded-lg shadow-xl button hover:bg-amber-400">
                Pay with Razorpay
            </button>
            <p class="mt-4 text-sm text-gray-400 text-center">
                After payment, please wait for automatic verification. Do not close this window.
            </p>
        </div>
    </div>

    <!-- Step 4: Confirmation & Redirect -->
    <div id="popup-step-4" class="popup-container">
        <div class="popup-content golden-border">
            <h2 id="welcome-heading" class="text-2xl sm:text-3xl font-bold mb-4 golden-text-gradient drop-shadow-lg"></h2>
            <p class="text-gray-300 text-sm md:text-base leading-relaxed mb-8">
                Aapka dhanyawad! Aapka bhugtaan safal raha. Ab aap ek naye safar ki shuruaat karne ke liye taiyaar hain. Is chote se kadam se, aapne bade maukon ke liye darwaza khol diya hai.
            </p>
            <p class="text-gray-400 text-xs mb-4">
                (Hum aapke liye sabkuch set kar rahe hain...)
            </p>
            <div id="loader" class="mx-auto my-4 loader"></div>
            <button id="okay-button" class="w-full px-6 py-3 mt-4 text-xl font-bold text-gray-900 bg-amber-500 rounded-lg shadow-xl button hover:bg-amber-400 hidden">
                Okay
            </button>
        </div>
    </div>

    <script>
        const popupStep1 = document.getElementById('popup-step-1');
        const popupStep2 = document.getElementById('popup-step-2');
        const popupStep3Payment = document.getElementById('popup-step-3-payment');
        const popupStep4 = document.getElementById('popup-step-4');
        const formStep1 = document.getElementById('form-step-1');
        const nameInput = document.getElementById('name');
        const step1Heading = document.getElementById('step-1-heading');
        const payButton = document.getElementById('pay-button');
        const okayButton = document.getElementById('okay-button');
        const welcomeHeading = document.getElementById('welcome-heading');
        const loader = document.getElementById('loader');
        const secretCodeSection = document.getElementById('secret-code-section');
        const secretCodeInput = document.getElementById('secret-code');
        const secretOkayButton = document.getElementById('secret-okay-button');
        const paymentText = document.getElementById('payment-text');
        const razorpayPaymentBtn = document.getElementById('razorpay-payment-btn');
        const paymentSummary = document.getElementById('payment-summary');
        const timerDisplay = document.getElementById('timerDisplay');

        let userData = {};
        let transactionId = '';
        const amount = 77;
        const PAYMENT_TIME_LIMIT = 5 * 60;
        let countdownInterval = null;

        const hasPaid = localStorage.getItem('hasPaid');
        if (hasPaid === 'true') {
            window.location.href = 'govt-all-services.html';
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                popupStep1.style.display = 'flex';
            });
        }

        nameInput.addEventListener('input', (e) => {
            const name = e.target.value.trim();
            step1Heading.innerHTML = `<span class="golden-text-gradient">${name ? `${name}, Aapka Swagat Hai!` : 'Abhi Shuru Karen!'}</span>`;
        });

        formStep1.addEventListener('submit', (e) => {
            e.preventDefault();
            userData.name = nameInput.value.trim();
            userData.number = document.getElementById('number').value.trim();
            userData.email = document.getElementById('email').value.trim();

            if (userData.name && userData.number && userData.email) {
                popupStep1.style.display = 'none';
                popupStep2.style.display = 'flex';

                const nameParts = userData.name.toLowerCase().split(' ');
                const lastName = nameParts[nameParts.length - 1];
                if (lastName === 'insa' || lastName === 'insha' || lastName === 'insan') {
                    secretCodeSection.classList.remove('hidden');
                    payButton.classList.add('hidden');
                    paymentText.classList.add('hidden');
                } else {
                    secretCodeSection.classList.add('hidden');
                    payButton.classList.remove('hidden');
                    paymentText.classList.remove('hidden');
                }
            } else {
                alert("Kripya sabhi jaankari bharen.");
            }
        });

        secretCodeInput.addEventListener('input', (e) => {
            secretOkayButton.classList.toggle('hidden', e.target.value !== 'MSGMSGMSG');
        });

        secretOkayButton.addEventListener('click', () => {
            showWelcomePopup();
            const data = {
                name: userData.name,
                number: userData.number,
                email: userData.email,
                amount: 'Dera-Premi',
                transaction_id: 'Dhan Dhan Satguru Tera Hi Ashsra ji'
            };
            sendDataToGoogleSheets(data, true);
        });

        payButton.addEventListener('click', () => {
            popupStep2.style.display = 'none';
            popupStep3Payment.style.display = 'flex';
            paymentSummary.innerHTML = `<p class="text-xl font-bold">Total Payable: ₹${amount}</p>`;
            startPaymentTimer();
        });

        razorpayPaymentBtn.addEventListener('click', handleRazorpayPayment);

        function handleRazorpayPayment() {
            const razorpayKey = 'rzp_live_zyUA84YdEZR7rO';
            const options = {
                key: razorpayKey,
                amount: amount * 100,
                currency: "INR",
                name: "All Government Job Services",
                description: "Complete Guide, Video Lectures, and Notes",
                handler: function (response) {
                    transactionId = response.razorpay_payment_id;
                    const data = {
                        name: userData.name,
                        number: userData.number,
                        email: userData.email,
                        amount: amount,
                        transaction_id: transactionId
                    };
                    showWelcomePopup();
                    sendDataToGoogleSheets(data, false);
                },
                prefill: {
                    name: userData.name,
                    email: userData.email,
                    contact: userData.number,
                },
                theme: {
                    color: "#FFD700"
                }
            };
            const rzp1 = new Razorpay(options);
            rzp1.on('payment.failed', (response) => {
                alert("Payment failed: " + response.error.description);
                popupStep3Payment.style.display = 'none';
                popupStep2.style.display = 'flex';
            });
            rzp1.open();
        }

        function startPaymentTimer() {
            let timeLeft = PAYMENT_TIME_LIMIT;
            const updateDisplay = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `Time remaining: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            };
            updateDisplay();

            countdownInterval = setInterval(() => {
                timeLeft--;
                updateDisplay();
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                    alert("Payment time expired. Please try again.");
                    popupStep3Payment.style.display = 'none';
                    popupStep2.style.display = 'flex';
                }
            }, 1000);
        }

        function showWelcomePopup() {
            clearInterval(countdownInterval);
            popupStep3Payment.style.display = 'none';
            popupStep2.style.display = 'none';
            popupStep4.style.display = 'flex';
            welcomeHeading.innerHTML = `<span class="golden-text-gradient">${userData.name}, Aapka Dhanyawad!</span>`;
        }

        async function sendDataToGoogleSheets(data, isSecretCode) {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxOET0tOiJTHgYVDlBWyz6-rAHMQqd32_ezqmQa13HSQv-DVo3ZvQtNppPZgHcISApXhw/exec';
            const formData = new FormData();
            formData.append('name', data.name);
            formData.append('number', data.number);
            formData.append('email', data.email);
            formData.append('amount', data.amount);
            formData.append('transaction_id', data.transaction_id);

            try {
                const response = await fetch(scriptURL, { method: 'POST', body: formData });
                if (response.ok) {
                    loader.style.display = 'none';
                    localStorage.setItem('hasPaid', 'true');
                    okayButton.style.display = 'block';
                } else {
                    console.error('Error sending data:', response.statusText);
                    loader.style.display = 'none';
                    okayButton.style.display = 'block';
                    alert("Data Google Sheet mein bhejne mein koi samasya hui. Kripya baad mein prayas karen.");
                }
            } catch (error) {
                console.error('Error:', error);
                loader.style.display = 'none';
                okayButton.style.display = 'block';
                alert("Network error: Data Google Sheet mein nahi bheja ja saka.");
            }
        }

        okayButton.addEventListener('click', () => {
            window.location.href = 'govt-all-services.html';
        });
    </script>
</body>
</html>
